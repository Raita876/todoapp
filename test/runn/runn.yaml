desc: todoappserver E2E test
runners:
  req: http://localhost:8080/api/v1
steps:
  get_tasks:
    req:
      /tasks:
        get:
          body:
            application/json: null
    test: |
      steps.get_tasks.res.status == 200
      && len(steps.get_tasks.res.body.tasks) == 5
  get_tasks_with_name:
    req:
      /tasks?name=Three:
        get:
          body:
            application/json: null
    test: |
      steps.get_tasks_with_name.res.status == 200
      && len(steps.get_tasks_with_name.res.body.tasks) == 1
      && steps.get_tasks_with_name.res.body.tasks[0].id == "07aaadbc-8967-406f-aebd-58b289377aef"
  get_tasks_with_status_id:
    req:
      /tasks?status_id=1:
        get:
          body:
            application/json: null
    test: |
      steps.get_tasks_with_status_id.res.status == 200
      && len(steps.get_tasks_with_status_id.res.body.tasks) == 2
      && steps.get_tasks_with_status_id.res.body.tasks[0].id == "b81240b0-7122-4d06-bdb2-8bcf512d6c63"
      && steps.get_tasks_with_status_id.res.body.tasks[1].id == "07aaadbc-8967-406f-aebd-58b289377aef"
  get_tasks_error_with_status_id:
    req:
      /tasks?status_id=invalid:
        get:
          body:
            application/json: null
    test: |
      steps.get_tasks_error_with_status_id.res.status == 400
  get_tasks_with_sort_by_and_order:
    req:
      /tasks?sort_by=updated_at&order=desc:
        get:
          body:
            application/json: null
    test: |
      steps.get_tasks_with_sort_by_and_order.res.status == 200
      && len(steps.get_tasks_with_sort_by_and_order.res.body.tasks) == 5
      && steps.get_tasks_with_sort_by_and_order.res.body.tasks[0].id == "b5e93ba4-ce33-4e36-83cb-c71177464a25"
      && steps.get_tasks_with_sort_by_and_order.res.body.tasks[1].id == "8b119430-438b-40d1-a28d-3d11d6afcfba"
      && steps.get_tasks_with_sort_by_and_order.res.body.tasks[2].id == "07aaadbc-8967-406f-aebd-58b289377aef"
      && steps.get_tasks_with_sort_by_and_order.res.body.tasks[3].id == "fad796a1-e0ed-4ee5-9f88-9b7258d35ae9"
      && steps.get_tasks_with_sort_by_and_order.res.body.tasks[4].id == "b81240b0-7122-4d06-bdb2-8bcf512d6c63"
  get_tasks_error_with_sort_by_and_order:
    req:
      /tasks?sort_by=invalid&order=desc:
        get:
          body:
            application/json: null
    test: |
      steps.get_tasks_error_with_sort_by_and_order.res.status == 500    
  get_task_by_id:
    req:
      /tasks/b81240b0-7122-4d06-bdb2-8bcf512d6c63:
        get:
          body:
            application/json: null
    test: |
      steps.get_task_by_id.res.status == 200
      && steps.get_task_by_id.res.body.id == "b81240b0-7122-4d06-bdb2-8bcf512d6c63"
  get_task_by_id_error:
    req:
      /tasks/0922ebda-cc4f-4eeb-b360-61f9df22b804:
        get:
          body:
            application/json: null
    test: |
      steps.get_task_by_id_error.res.status == 500
  post_tasks:
    req:
      /tasks:
        post:
          body:
            application/json:
              name: "task for scenario test"
              description: "This is task for scenario test"
              status_id: 0
    test: |
      steps.post_tasks.res.status == 201
  post_tasks_error:
    req:
      /tasks:
        post:
          body:
            application/json:
              name: ""
              description: ""
              status_id: 1
    test: |
      steps.post_tasks_error.res.status == 500
  update_task:
    req:
      /tasks:
        put:
          body:
            application/json:
              id: "fad796a1-e0ed-4ee5-9f88-9b7258d35ae9"
              name: "updated taskt"
              description: "This is updated task"
              status_id: 5
    test: |
      steps.update_task.res.status == 200
      && steps.update_task.res.body.id == "fad796a1-e0ed-4ee5-9f88-9b7258d35ae9"
  update_task_error:
    req:
      /tasks:
        put:
          body:
            application/json:
              id: "fad796a1-e0ed-4ee5-9f88-9b7258d35ae9"
              name: ""
              description: ""
              status_id: 6
    test: |
      steps.update_task_error.res.status == 500
  delete_task:
    req:
      /tasks:
        delete:
          body:
            application/json:
              id: "07aaadbc-8967-406f-aebd-58b289377aef"
    test: |
      steps.delete_task.res.status == 204
  delete_task_not_found:
    req:
      /tasks:
        delete:
          body:
            application/json:
              id: "d9cfcbfe-d086-4049-8f10-96eefd320042"
    test: |
      steps.delete_task_not_found.res.status == 500
